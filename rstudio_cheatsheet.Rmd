---
title: "RStudio Cheatsheet"
author: "Annette Hilton"
date: "2/11/2020"
output: html_document
toc: true
toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Attach necessary packages 

library(tidyverse)
library(here)
library(janitor)

```

# Introduction 

This is a RStudio cheatsheet designed to assist coders as a one-stop reference for basic RStudio functions. 

**Please note:** This document is a work in progress and may contain code that does not run in the cheatsheet. It is designed to be a quick reference, code may be copy/pasted from other projects; in the future, self-contained coding examples may be pursued. 

The cheatsheet is broken down into the following sections (Table of Contents):

- Set global options
- Helpful packages 
- Read in Data 
- Tidy data
- Sort/Modify data
  - Sort by column 
  - Create new column/modify column
  - Sort by row
  - Modify/change rows
- Saving Files/Graphs 
  - Save to specific pathway
  - Save file
  - Save graph
- Working with Dates
- Graphs/Visualization 
- Statistical Tests 
- Create new data
- Rmd Tips 
  - General Formatting 
  - Tabs 
  - Themes
  - Insert a photo 
- Shiny Apps

# Cheatsheet Main 

## Set global options 

How to set global options for Rmd/Other 

```{r}
#---------------------------------------------------
# Set global options
#---------------------------------------------------

# In top code chunk: knitr::opts_chunk$set(echo = TRUE)

# Do not display messages 

message = FALSE 

# Do not display errors

error = FALSE 

# Do not display warnings 

warning = FALSE 

# No code in final output 

echo = FALSE 

# Disable scientific notation 

options(scipen=999)

# Disable output 

ouput = FALSE 

```

## Helpful packages 

```{r}
#--------------------------------------------------
# Helpful Packages 
#--------------------------------------------------

library(tidyverse) # Most basic and helpful! 
library(janitor) # Helps with cleaning/data tidy 
library(here) # Specifies where a file is located
library(sf) # Must have to read in spatial data 
library(paletteer) # Amazing resource of so many different types of discrete colors! 

```


## Read in Data

Read in CSV or TSV files 

```{r}
#--------------------------------------------------
# Read in data (csv or tsv)
#--------------------------------------------------

# Read in csv 

readr::read_csv("file_name")

# Read in csv with specific file path 

readr::read_csv(here::here("folder_name", "file_name")) 

# Read in tsv 

readr::read_tsv("file_name")

```

Read in spatial data 

```{r}
#-------------------------------------------------
# Read in shapefile/spatial data 
#-------------------------------------------------

# Must have package `sf` installed 

read_sf(dsn = here::here("folder_name", "subfolder_name"), layer = "name_of_all_files_name" )

```


## Tidy Data

```{r}
#-------------------------------------------------
# Basic data tidying
#-------------------------------------------------

# Tidy column names to all lowercase (pipe into)

example_dataframe <- dataframe_original %>% 
clean_names() 

# Rename column names with `rename()`

example_dataframe <- dataframe_original %>% 
  rename(new_column_name = old_column_name)

# Tidy rows/observations to lowercase 
# Overwrite column name with lowercase rows with `mutate()` and `str_to_lower()`

example_dataframe <- dataframe_original %>% 
  mutate(example_column_name = str_to_lower(example_column_name))

# Separate one column into two based on a separator (such as "x.2" or "Jan:1")

example_dataframe <- dataframe_original %>% 
  separate("example_column_name", c("new_column", "second_new_column"))

```


## Sort Data 
### Sort by column 

```{r}
# Sort columns by function `select()`

# Keep columns 
example_dataframe <- original_dataframe %>% 
  select(column_to_keep, other_column) 

# Remove columns 



```

### Create new column/modify column 
### Sort by row 

```{r}
#------------------------------------------------------------------------------------------
# Sort by row 
#------------------------------------------------------------------------------------------

# Use `filter()` function 
# Note: Other `filter()` options exist, such as: 

filter_all()
filter_if()
filter_at()

# Filter by string pattern/text (keep)

example_dataframe <- dataframe_original %>% 
  filter(str_detect(example_column_name, pattern = "example_pattern"))

# Filter by string pattern/text (remove: !) 

example_dataframe <- dataframe_original %>% 
  filter(!str_detect(example_column_name, pattern = "example_pattern"))

# Keep top certain number with function `head()` 

# Change/modify row names with function `rownames()` (including from another dataframe) 


```

### Modify/change rows 

```{r}
# Add character to row string by `sub()` function 

example_dataframe$example_column <- sub("^", "character_to_add", example_dataframe$example_column)

# Remove character to row string by `gsub()` function 
# You can add a character in its place or simply use "" to have nothing

example_dataframe$example_column <- gsub("character_to_remove", "character_to_add", example_dataframe$example_column)

```


## Saving Files/Graphs 

## Working with Dates

## Graphs/Visualization

### ggplot 

```{r}
# ggplot provides nearly endless visualizations and customizations 

# Basic plot 
# geom_line as an example 

ggplot(data = example_dataframe, 
       aes(x = x_axis_variable, 
           y = y_axis_variable, 
           group = aesthetic_variable_to_group_by)) +
  geom_line() 

```

Seasonal Plot 
```{r}

# Seasonal graph (example)

seasonal_plot <- ggplot(data = steelhead_parsed, 
       aes(x = month, y = total, group = year)) +
  geom_line(aes(color = year)) +
  facet_wrap(~ parameter, 
             ncol = 1, 
             scales = "free", 
             strip.position = "right")
```

```{r}
# Create line graph of Mono Lake Level from 1850-2017 

# Basic plot 

ggplot(data = mono_annual_levels, 
       aes(x = year, 
           y = lake_level_feet_above_sea_level)) +
  geom_line(aes(color = mycolor), size = 1.9) + # Set to color line conditionally 
  theme_light() + # Overall theme and customization 
  theme(legend.position = "none") + # No legend 
  theme( # Customize specifics
    text = element_text(family = "Microsoft Tai Le", 
                        size = 15)) + # Customize text of entire plot, size 
 
# Insert extra lines for Stable Lake Level and Land Bridges Emerge (just the line)
   geom_hline( 
    yintercept = 6392, 
    color = "darkblue", 
    size = 0.9, 
    linetype = "dashed") +
  geom_hline(
    yintercept = 6377, 
    color = "darkred", 
    size = 0.9, 
    linetype = "dashed") +
  
# Limit the axis scale to specific region 
 scale_x_continuous( 
    limits = c(1850,2020), 
    expand = c(0,0)) + 
  scale_y_continuous(
    limits = c(6370, 6430), 
    expand = c(0,0)) +
  
# Customize the gridlines 
  theme(panel.grid.major = element_line(
    size = 0.5, 
    linetype = "solid", 
    color = "lightgray"),
    panel.grid.minor = element_blank()) +
  
# Add axis labels, title, subtitle 
  labs(x = "Year", 
       y = "Lake Level above Sea Level (ft)",
       title = "A HISTORY OF MONO LAKE", 
       subtitle = "Lake Levels 1850-2017") + 

# Customize the labels (from above) 
  theme(plot.title = element_text(hjust = 0.5), # Center the title and subtitle 
        plot.subtitle = element_text(hjust = 0.5)) +
  
# Add text on the graph for Stable Lake Level and Land Bridges Emerge and Lake Diversion Begins 1941
  geom_text(aes(x = 1875, 
                y = 6393.5, 
                label = "Stable Lake Level"), 
            color = "darkblue", 
            size = 5,
            family = "Calibri") +
  geom_text(aes(x = 1925, 
                y = 6378.5, 
                label = "Land Bridges Emerge"),
            color = "darkred", 
            size = 5,
            family = "Calibri") +
  geom_text(aes(x = 1975, 
                y = 6426, 
                label = "Lake Diversion Begins in 1941"), 
            family = "Calibri", size = 4.5) + 
  annotate("segment", # Add arrow 
           x = 1975, 
           xend = 1945, 
           y = 6425, 
           yend = 6418, 
           color = "red", 
           size = 2, 
           alpha = 0.6, 
           arrow = arrow()) +
  geom_point(aes(x = 1941, # Add red point 
                 y = 6417), 
             color = "red",
             size = 4)
 
```

Disable scientific notation in ggplot 
```{r}
# Disable scientific notation of y-axis 
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE))

```

## Statistical Tests 

## Create new data

## Rmd Tips 

### General Formatting 

```{r}
#---------------------------------------------------------------------------------------
# General formatting
#---------------------------------------------------------------------------------------

# Bold, italicized, bold and italicized 

**bold** 
  
*italicized* 
  
***bold and italicized***
  
# Hyperlink word/text 
  
[Example of words to hyperlink](https://www.youtube.com/watch?v=BMuknRb7woc)
  
```

### Tabs {.tabset}

#### Example of Tab 

#### Second Example of Tab 

### Themes 

```{r}
# Various themes exist for Rmd
# To check them out, refer to this:

# https://bookdown.org/yihui/rmarkdown/html-document.html#appearance_and_style

```


### Insert photo

```{r}
# Insert a photo, specify width, center image 

<center> ![](folder_with_images/example_photo.jpg){width=450px} ![](folder_with_images/example_photo.jpg){width=450px} </center>
  
```




### Table of contents 

## Shiny Apps 